<!DOCTYPE html>
    <!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2019-08-04 
 | Rendered using BloomReach Forge Maven Skin 3.0.1 based on Apache Maven Fluido Skin
-->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                  <meta name="Date-Revision-yyyymmdd" content="20190804" />
              <meta http-equiv="Content-Language" content="en" />
      <title>Hippo Repository JCR/WebDAV Support &#x2013; Example - WebFiles via WebDAV</title>
  <link rel="stylesheet" href="./css/forge-maven-skin-syntaxhighlighter-3.0.1.min.css"/>
  <link rel="stylesheet" href="./css/forge-maven-skin-3.0.1.min.css"/>
  <link rel="stylesheet" href="./css/site.css" />
  <link rel="stylesheet" href="./css/print.css" media="print" />
  <link rel="icon" type="image/png" href="./images/skin/logo_64.png" sizes="64x64">

  
  <script type="text/javascript" src="./js/forge-maven-skin-syntaxhighlighter-3.0.1.min.js"></script>
  <script type="text/javascript" src="./js/forge-maven-skin-3.0.1.min.js"></script>

    </head>
<body class="topBarDisabled">
                        <a href="https://github.com/bloomreach-forge/hippo-jcr-over-webdav">
    <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
         src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
         alt="Fork me on GitHub">
  </a>
          <div class="container-fluid">
  <div id="banner">
    <div id="logo">
      <a href="http://www.github.com/bloomreach-forge">
        <img src="./images/skin/logo.png" alt="BloomReach Forge Logo" />
      </a>
    </div>
    <div class="pull-left">              <div id="bannerLeft">    <h1>Hippo Repository JCR/WebDAV Support</h1>
    </div>
              </div>
    <div class="pull-right"></div>
    <div class="clear"><hr/></div>
  </div>

  <div id="breadcrumbs">
    <div class="links">
      <a href="https://developers.bloomreach.com">developers.bloomreach.com</a>
      <a href="https://www.onehippo.org">onehippo.org</a>
    </div>
    <ul class="breadcrumb">
    
  <li id="publishDate">published: 2019-08-04  
  </li>
  
        
            </ul>
    <div class="clear"><hr/></div>
  </div>
<div class="row-fluid">
  <div id="leftColumn" class="span2">
    <div class="well sidebar-nav">
    
    <ul class="nav nav-list">
            <li class="nav-header">Main</li>
              <li>  <a href="index.html" title="Welcome">  <span class="none"></span>  Welcome</a>  </li>
        <li>  <a href="install.html" title="Installation">  <span class="none"></span>  Installation</a>  </li>
        <li>  <a href="remote-repository.html" title="How to Use Remote Repository">  <span class="none"></span>  How to Use Remote Repository</a>  </li>
        <li>  <a href="cmd-examples.html" title="Command Line Examples">  <span class="none"></span>  Command Line Examples</a>  </li>
                                                    <li>  <a href="simple-webdav-support.html" title="Simple WebDAV Support">  <span class="icon-chevron-down"></span>  Simple WebDAV Support</a>  
    <ul class="nav nav-list">
                  <li class="active">  <a href="#"><span class="none"></span>Example - WebFiles via WebDAV</a>
  </li>
                        <li>  <a href="simple-webdav-security-integration.html" title="Advanced - Security Framework Integration">  <span class="none"></span>  Advanced - Security Framework Integration</a>  </li>
              </ul>
  </li>
        <li>  <a href="release-notes.html" title="Release Notes">  <span class="none"></span>  Release Notes</a>  </li>
                  <li class="nav-header">Autogenerated Docs</li>
                                                                                                                                                                                                                                                    <li>  <a href="project-info.html" title="Project Information">  <span class="icon-chevron-right"></span>  Project Information</a>  </li>
                                          <li>  <a href="project-reports.html" title="Project Reports">  <span class="icon-chevron-right"></span>  Project Reports</a>  </li>
        </ul>
    
          <hr />
      <div id="poweredBy">
                <div class="clear"></div>
                <div class="clear"></div>
                <div class="clear"></div>
                <div class="clear"></div>
              <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">  <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />  </a>
          </div>
    </div>
  </div>
  <div id="bodyColumn"  class="span10" >
    
  

    <div class="section">
<h2><a name="Example_-_WebFiles_via_WebDAV"></a>Example - WebFiles via WebDAV</h2>

      
<div class="section">
<h3><a name="Introduction"></a>Introduction</h3>
        
<p>
          In this page, a scenario utilizing
          <a class="externalLink" href="http://jackrabbit.apache.org/jcr/components/jackrabbit-web-application.html#Simple_Webdav_Server">Jacktabbit Simple Webdav Server</a>
          with Hippo CMS is explained as an example.
        </p>
        
<p>
          <a class="externalLink" href="https://www.onehippo.org/library/concepts/web-files/web-files-introduction.html">WebFiles</a> in Hippo CMS
          uses the default JCR folders (<tt>nt:folder</tt>) and files (<tt>nt:file</tt>) to store the files.
          So, it is easily mapped to WebDAV representations as collections and files.
        </p>
        
<p>
          We will expose the <a class="externalLink" href="https://www.onehippo.org/library/concepts/web-files/web-files-introduction.html">WebFiles</a>
          as WebDAV collection and show how to browse, download and upload files by using a WebDAV client tool below.
        </p>
      </div>

      
<div class="section">
<h3><a name="WebDAV_Client_Tools"></a>WebDAV Client Tools</h3>
        
<p>
          There are many WebDAV client tools including populr web browsers (for browsing and reading at least),
          according to a <a class="externalLink" href="https://en.wikipedia.org/wiki/Comparison_of_WebDAV_software">Comparison of WebDAV software</a> Wikipedia page.
          So, it is almost impossible to introduce all the available client tools here, but the following tools are found useful:
        </p>
        
<ul>
          
<li>
            <b>Cadaver</b>:
            Command line tool, providing more than similar features to SFTP such as
            <tt>get</tt>, <tt>mget</tt>, <tt>put</tt>, <tt>mput</tt>, <tt>copy</tt>, <tt>move</tt>,
            <tt>delete</tt>, <tt>cat</tt>, <tt>edit</tt>, ...
          </li>
          
<li>
            <b><a class="externalLink" href="https://cyberduck.io/">CyberDuck</a></b>:
            GUI tool for MacOS and Windows, providing a synchronization feature between local folder and WebDAV collection.
          </li>
          
<li>
            <b>DaviX</b>:
            Command line tool, used at <a class="externalLink" href="https://en.wikipedia.org/wiki/CERN">CERN</a> by several projects.
          </li>
          
<li>
            <b><a class="externalLink" href="https://www.eclipse.org/eclipse/platform-team/target.php">Eclipse supports WebDAV plugin</a></b>
          </li>
        </ul>
        
<p>
          In this page, we are going to use <b>Cadaver</b> to demonstrate how to access WebFiles through WebDAV.
        </p>
        
<p>
          To install <b>Cadaver</b>,
        </p>
        
<ul>
          
<li>
            For Mac, you can install it by executing <tt>brew install cadaver</tt>.
            See <a class="externalLink" href="http://macappstore.org/cadaver/">http://macappstore.org/cadaver/</a> for more detail.
          </li>
          
<li>
            For linux, see <a class="externalLink" href="https://pkgs.org/download/cadaver">https://pkgs.org/download/cadaver</a>.
          </li>
          
<li>
            For Windows, see <a class="externalLink" href="http://www.phtagr.org/2009/04/01/cadaver-for-windows/">http://www.phtagr.org/2009/04/01/cadaver-for-windows/</a>.
          </li>
        </ul>
      </div>

      
<div class="section">
<h3><a name="Exposing_WebFiles_as_WebDAV_Collection"></a>Exposing WebFiles as WebDAV Collection</h3>
        
<p>
          If you followed the <a href="simple-webdav-support.html">Simple Webdav Server Installation</a> step,
          then the <tt>/webfiles</tt> JCR node is already exposed through WebDAV path: <tt>/default/webfiles/</tt>.
          e.g. <tt>http://localhost:8080/cms/webdav/default/webfiles/</tt>.
        </p>
        
<p>
          Note that <tt>/cms</tt> is the context path of the web application where you've set up the Simple WebDAV Server,
          <tt>/webdav</tt> is the servlet mapping path you've configured in the <tt>web.xml</tt>,
          <tt>/default</tt> is the JCR workspace name and Hippo CMS uses the <tt>default</tt> workspace only,
          and finally <tt>/webfiles</tt> is the JCR node path you want to access.
        </p>
        
<p>
          However, for security reason, you might want to limit WebDAV access only to <tt>/webfiles</tt> node,
          not anywhere else such as <tt>/content</tt> or <tt>/hippo:configuration</tt>.
          To achieve that, the demo project simply leveraged the <a class="externalLink" href="http://tuckey.org/urlrewrite/">Tuckey UrlRewriteFilter</a>.
          by setting <tt>UrlRewriteFilter</tt> servlet filter in
          <a class="externalLink" href="https://github.com/bloomreach-forge/hippo-jcr-over-webdav/blob/develop/demo/cms/src/main/webapp/WEB-INF/web.xml">/WEB-INF/web.xml</a>
          with a custom
          <a class="externalLink" href="https://github.com/bloomreach-forge/hippo-jcr-over-webdav/blob/develop/demo/cms/src/main/webapp/WEB-INF/urlrewrite.xml">/WEB-INF/urlrewrite.xml</a>
          like the following examples:
        </p>

        
<p>&#160;</p>
        
<p>/WEB-INF/web.xml:</p>
        
<div class="brush: xml">
        
<div class="source"><pre>

  &lt;!-- SNIP --&gt;

  &lt;!-- This UrlRewriteFilter is a demo only to control requests to /webdav/*. --&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;UrlRewriteFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.tuckey.web.filters.urlrewrite.UrlRewriteFilter&lt;/filter-class&gt;
  &lt;/filter&gt;

  &lt;!-- SNIP --&gt;

  &lt;!-- This UrlRewriteFilter is a demo only to control requests to /webdav/*. --&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;UrlRewriteFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/webdav/*&lt;/url-pattern&gt;
    &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
    &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
  &lt;/filter-mapping&gt;

  &lt;!-- SNIP --&gt;

        </pre></div>
        </div>

        
<p>&#160;</p>
        
<p>/WEB-INF/urlrewrite.xml:</p>
        
<div class="brush: xml">
        
<div class="source"><pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE urlrewrite PUBLIC &quot;-//tuckey.org//DTD UrlRewrite 4.0//EN&quot; &quot;http://www.tuckey.org/res/dtds/urlrewrite4.0.dtd&quot;&gt;
&lt;urlrewrite&gt;

    &lt;rule match-type=&quot;regex&quot;&gt;
        &lt;note&gt;
            The rule means that requests to /webdav will be redirected to /webdav/default/webfiles/
            the url will be rewritten.
        &lt;/note&gt;
        &lt;from&gt;^\/webdav$&lt;/from&gt;
        &lt;to type=&quot;redirect&quot; last=&quot;true&quot;&gt;webdav/default/webfiles/&lt;/to&gt;
    &lt;/rule&gt;

    &lt;rule match-type=&quot;regex&quot;&gt;
        &lt;note&gt;
            The rule means that requests to /webdav/ will be redirected to /webdav/default/webfiles/
            the url will be rewritten.
        &lt;/note&gt;
        &lt;from&gt;^\/webdav\/([^\/]*)$&lt;/from&gt;
        &lt;to type=&quot;redirect&quot; last=&quot;true&quot;&gt;default/webfiles/$1&lt;/to&gt;
    &lt;/rule&gt;

    &lt;rule match-type=&quot;regex&quot;&gt;
        &lt;note&gt;
            The rule means that requests to /webdav/*, other than /webdav/default/webfiles/*, will be resulted in 403 error.
        &lt;/note&gt;
        &lt;from&gt;^(?!\/webdav\/default\/webfiles\/?.*).*$&lt;/from&gt;
        &lt;set type=&quot;status&quot;&gt;403&lt;/set&gt;
        &lt;to last=&quot;true&quot;&gt;null&lt;/to&gt;
    &lt;/rule&gt;

&lt;/urlrewrite&gt;
        </pre></div>
        </div>

      </div>

      
<div class="section">
<h3><a name="Access_with_WebDAV_Client_Tool"></a>Access with WebDAV Client Tool</h3>
        
<p>
          Here's <b>cadaver</b> command examples to download files, edit and upload files.
        </p>
        
<div class="brush: plain">
        
<div class="source"><pre>
$ cadaver http://localhost:8080/cms/webdav/default/webfiles/
Authentication required for Hippo Repository WebDAV Access Support on server `localhost':
Username: admin
Password: 

dav:/cms/webdav/default/webfiles/&gt; help
Available commands: 
 ls         cd         pwd        put        get        mget       mput       
 edit       less       mkcol      cat        delete     rmcol      copy       
 move       lock       unlock     discover   steal      showlocks  version    
 checkin    checkout   uncheckout history    label      propnames  chexec     
 propget    propdel    propset    search     set        open       close      
 echo       quit       unset      lcd        lls        lpwd       logout     
 help       describe   about      
Aliases: rm=delete, mkdir=mkcol, mv=move, cp=copy, more=less, quit=exit=bye

dav:/cms/webdav/default/webfiles/&gt; ls
Listing collection `/cms/webdav/default/webfiles/': succeeded.
Coll:   site                                   0  Oct  5 11:48

dav:/cms/webdav/default/webfiles/&gt; cd site/freemarker/hipporepojcrdavdemo
dav:/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/&gt; ls
Listing collection `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/': succeeded.
        base-footer.ftl                      244  Oct  5 10:24
        base-layout.ftl                     1012  Oct  5 10:24
        base-top-menu.ftl                   1194  Oct  5 10:24
        homepage-main.ftl                    516  Oct  5 10:24
        pagenotfound-main.ftl                299  Oct  5 10:24

dav:/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/&gt; mget *.ftl
[Matching... 5 matches.]
Downloading `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/pagenotfound-main.ftl' to pagenotfound-main.ftl:
Progress: [=============================&gt;] 100.0% of 299 bytes succeeded.
Downloading `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/homepage-main.ftl' to homepage-main.ftl:
Progress: [=============================&gt;] 100.0% of 516 bytes succeeded.
Downloading `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/base-top-menu.ftl' to base-top-menu.ftl:
Progress: [=============================&gt;] 100.0% of 1194 bytes succeeded.
Downloading `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/base-layout.ftl' to base-layout.ftl:
Progress: [=============================&gt;] 100.0% of 1012 bytes succeeded.
Downloading `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/base-footer.ftl' to base-footer.ftl:
Progress: [=============================&gt;] 100.0% of 244 bytes succeeded.
        </pre></div>
        </div>
        
<p>
          Now, you can edit and save the downloaded FreeMarker template files locally, using your favoirte editor.
          Afterward, you can upload the files.
          Of course, you may use <tt>get</tt> and <tt>put</tt> command instead for single file.
        </p>
        
<div class="brush: plain">
        
<div class="source"><pre>
dav:/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/&gt; mput *.ftl
[Matching... 5 matches.]
Uploading base-top-menu.ftl to `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/base-top-menu.ftl':
Progress: [=============================&gt;] 100.0% of 1194 bytes succeeded.
Uploading pagenotfound-main.ftl to `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/pagenotfound-main.ftl':
Progress: [=============================&gt;] 100.0% of 299 bytes succeeded.
Uploading base-layout.ftl to `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/base-layout.ftl':
Progress: [=============================&gt;] 100.0% of 1012 bytes succeeded.
Uploading base-footer.ftl to `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/base-footer.ftl':
Progress: [=============================&gt;] 100.0% of 244 bytes succeeded.
Uploading homepage-main.ftl to `/cms/webdav/default/webfiles/site/freemarker/hipporepojcrdavdemo/homepage-main.ftl':
Progress: [=============================&gt;] 100.0% of 516 bytes succeeded.
        </pre></div>
        </div>
      </div>

    </div>

  

    </div>
    </div>
    </div>
    <hr/>
    <footer>
    <div class="container-fluid">
      <div class="row-fluid">
          <p class="copyright">Copyright &copy;      2019.
  BloomReach Inc. All rights reserved.
</p>
    </div>
            </div>
  </footer>
    </body>
</html>

